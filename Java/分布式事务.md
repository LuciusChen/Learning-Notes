事务的四大特性：原子性（Atomicity）、一致性（Consistency）、隔离性（Isolation）和持久性（Durability），简称 ACID。

在单体架构时代，所有的业务只用一个数据库，利用数据库本身提供的事务机制支持就可以。例如 MySQL 数据库：事务的隔离性是通过数据库锁的机现的。事务的一致性由 [undo log]() 来保证：undo log 是逻辑日志，记录了事务的`insert`、`update`、`delete`操作，回滚的时候做相反的`delete`、`update`、`insert`操作来恢复数据。事务的原子性和一持久性由 [redo log]() 来制实保证：redo log 被称作重做日志，是物理日志，事务提交的时候，必须先将事务的所有日志写入 redo log 持久化，到事务的提交操作才算完成。

## 分布式事务

[CAP](/Java/CAP.md) 理论，无法都满足，其中 P 是分布式的基础，只能根据实际情况在 C 和 A 中取舍。

### 2PC 两阶段提交

两阶段提交的思路可以概括为：参与者将操作成败通知协调者，再由协调者根据所有参与者的反馈情况决定各参与者是否要提交操作还是中止操作。

![](/Java/images/2PC.png)

### TODO

- [ ] undo log
- [ ] redo log